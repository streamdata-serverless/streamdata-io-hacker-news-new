!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("streamdataio",[],e):"object"==typeof exports?exports.streamdataio=e():t.streamdataio=e()}(this,function(){return function(t){function e(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,e),i.l=!0,i.exports}var n={};return e.m=t,e.c=n,e.i=function(t){return t},e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:r})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=103)}([function(t,e,n){var r=n(3),i=n(16),o=n(9),s=n(20),u=n(52),c=function(t,e,n){var a,l,f,h,p=t&c.F,d=t&c.G,v=t&c.S,g=t&c.P,_=t&c.B,y=d?r:v?r[e]||(r[e]={}):(r[e]||{}).prototype,m=d?i:i[e]||(i[e]={}),S=m.prototype||(m.prototype={});d&&(n=e);for(a in n)l=!p&&y&&void 0!==y[a],f=(l?y:n)[a],h=_&&l?u(f,r):g&&"function"==typeof f?u(Function.call,f):f,y&&s(y,a,f,t&c.U),m[a]!=f&&o(m,a,h),g&&S[a]!=f&&(S[a]=f)};r.core=i,c.F=1,c.G=2,c.S=4,c.P=8,c.B=16,c.W=32,c.U=64,c.R=128,t.exports=c},function(t,e,n){var r=n(0),i=n(7),o=n(2),s=/"/g,u=function(t,e,n,r){var i=String(o(t)),u="<"+e;return""!==n&&(u+=" "+n+'="'+String(r).replace(s,"&quot;")+'"'),u+">"+i+"</"+e+">"};t.exports=function(t,e){var n={};n[t]=e(u),r(r.P+r.F*i(function(){var e=""[t]('"');return e!==e.toLowerCase()||e.split('"').length>3}),"String",n)}},function(t,e){t.exports=function(t){if(void 0==t)throw TypeError("Can't call method on  "+t);return t}},function(t,e){var n=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},function(t,e,n){var r=n(14),i=Math.min;t.exports=function(t){return t>0?i(r(t),9007199254740991):0}},function(t,e,n){var r=n(35)("wks"),i=n(26),o=n(3).Symbol,s="function"==typeof o;(t.exports=function(t){return r[t]||(r[t]=s&&o[t]||(s?o:i)("Symbol."+t))}).store=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,i=n(27);!function(t){t[t.ERROR=0]="ERROR",t[t.WARN=1]="WARN",t[t.INFO=2]="INFO",t[t.DEBUG=3]="DEBUG"}(r=e.LogLevel||(e.LogLevel={}));var o=function(){function t(){}return t.setLevel=function(t){this._level=t},t.debug=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];this._level>=r.DEBUG&&this._console&&this._console.log&&this._console.log(this._formatLog(t,e))},t.info=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];this._level>=r.INFO&&this._console&&this._console.info&&this._console.info(this._formatLog(t,e))},t.warn=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];this._level>=r.WARN&&this._console&&this._console.warn&&this._console.warn(this._formatLog(t,e))},t.error=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];this._level>=r.ERROR&&this._console&&this._console.error&&this._console.error(this._formatLog(t,e))},t._formatLog=function(t,e){return t.replace?t.replace(/{(\d+)}/g,function(t,n){var r;if(e[n]&&"object"==typeof e[n]&&e[n]instanceof Error)try{r=e[n].message,e[n].stack&&console.error(e[n].stack)}catch(t){r=e[n]}else if(e[n]&&"object"==typeof e[n])try{r=e[n].toString!==Object.prototype.toString?e[n].toString():i.JsonHelper.stringify(e[n])}catch(t){r=e[n]}else r=e[n]&&"function"==typeof e[n]?"function":e[n]?e[n]:t;var o=""+r;return o.substring(0,Math.min(500,o.length))}):t},t}();o._console=console,o._level=r.INFO,e.Logger=o},function(t,e){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,e){var n={}.hasOwnProperty;t.exports=function(t,e){return n.call(t,e)}},function(t,e,n){var r=n(19),i=n(32);t.exports=n(11)?function(t,e,n){return r.f(t,e,i(1,n))}:function(t,e,n){return t[e]=n,t}},function(t,e,n){var r=n(13);t.exports=function(t){if(!r(t))throw TypeError(t+" is not an object!");return t}},function(t,e,n){t.exports=!n(7)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(t,e,n){"use strict";var r=n(9),i=n(20),o=n(7),s=n(2),u=n(5);t.exports=function(t,e,n){var c=u(t),a=n(s,c,""[t]),l=a[0],f=a[1];o(function(){var e={};return e[c]=function(){return 7},7!=""[t](e)})&&(i(String.prototype,t,l),r(RegExp.prototype,c,2==e?function(t,e){return f.call(t,this,e)}:function(t){return f.call(t,this)}))}},function(t,e){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,e){var n=Math.ceil,r=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?r:n)(t)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(6),i=function(){function t(){}return t.checkNotNull=function(t,e){if(void 0===t||null===t)throw e?new Error(e):new Error("value cannot be null");return t},t.deprecated=function(t,e){this.checkNotNull(t,"functionName cannot be null"),this.checkNotNull(e,"message cannot be null"),r.Logger.warn("'{0}' is deprecated because '{1}'.",t,e)},t.checkExpression=function(t,e){if(!t)throw e?new Error(e):new Error("expression is not valid")},t}();e.Preconditions=i},function(t,e){var n=t.exports={version:"2.4.0"};"number"==typeof __e&&(__e=n)},function(t,e,n){var r=n(5)("match");t.exports=function(t){var e=/./;try{"/./"[t](e)}catch(n){try{return e[r]=!1,!"/./"[t](e)}catch(t){}}return!0}},function(t,e,n){var r=n(13),i=n(28),o=n(5)("match");t.exports=function(t){var e;return r(t)&&(void 0!==(e=t[o])?!!e:"RegExp"==i(t))}},function(t,e,n){var r=n(10),i=n(55),o=n(67),s=Object.defineProperty;e.f=n(11)?Object.defineProperty:function(t,e,n){if(r(t),e=o(e,!0),r(n),i)try{return s(t,e,n)}catch(t){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(t[e]=n.value),t}},function(t,e,n){var r=n(3),i=n(9),o=n(8),s=n(26)("src"),u=Function.toString,c=(""+u).split("toString");n(16).inspectSource=function(t){return u.call(t)},(t.exports=function(t,e,n,u){var a="function"==typeof n;a&&(o(n,"name")||i(n,"name",e)),t[e]!==n&&(a&&(o(n,s)||i(n,s,t[e]?""+t[e]:c.join(String(e)))),t===r?t[e]=n:u?t[e]?t[e]=n:i(t,e,n):(delete t[e],i(t,e,n)))})(Function.prototype,"toString",function(){return"function"==typeof this&&this[s]||u.call(this)})},function(t,e,n){var r=n(35)("keys"),i=n(26);t.exports=function(t){return r[t]||(r[t]=i(t))}},function(t,e,n){var r=n(14),i=n(2);t.exports=function(t){return function(e,n){var o,s,u=String(i(e)),c=r(n),a=u.length;return c<0||c>=a?t?"":void 0:(o=u.charCodeAt(c),o<55296||o>56319||c+1===a||(s=u.charCodeAt(c+1))<56320||s>57343?t?u.charAt(c):o:t?u.slice(c,c+2):s-56320+(o-55296<<10)+65536)}}},function(t,e,n){var r=n(18),i=n(2);t.exports=function(t,e,n){if(r(e))throw TypeError("String#"+n+" doesn't accept regex!");return String(i(t))}},function(t,e,n){var r=n(0),i=n(2),o=n(7),s=n(65),u="["+s+"]",c="​",a=RegExp("^"+u+u+"*"),l=RegExp(u+u+"*$"),f=function(t,e,n){var i={},u=o(function(){return!!s[t]()||c[t]()!=c}),a=i[t]=u?e(h):s[t];n&&(i[n]=a),r(r.P+r.F*u,"String",i)},h=f.trim=function(t,e){return t=String(i(t)),1&e&&(t=t.replace(a,"")),2&e&&(t=t.replace(l,"")),t};t.exports=f},function(t,e,n){var r=n(56),i=n(2);t.exports=function(t){return r(i(t))}},function(t,e){var n=0,r=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++n+r).toString(36))}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(){}return t.validate=function(e){try{return t.parse(e),!0}catch(t){return!1}},t.parse=function(t){try{return JSON.parse(t)}catch(e){return t}},t.stringify=function(t){return t?JSON.stringify(t):"undefined"},t}();e.JsonHelper=r},function(t,e){var n={}.toString;t.exports=function(t){return n.call(t).slice(8,-1)}},function(t,e,n){var r=n(13),i=n(3).document,o=r(i)&&r(i.createElement);t.exports=function(t){return o?i.createElement(t):{}}},function(t,e){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(t,e,n){"use strict";var r=n(60),i=n(32),o=n(34),s={};n(9)(s,n(5)("iterator"),function(){return this}),t.exports=function(t,e,n){t.prototype=r(s,{next:i(1,n)}),o(t,e+" Iterator")}},function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},function(t,e){t.exports=function(t,e){var n=e===Object(e)?function(t){return e[t]}:e;return function(e){return String(e).replace(t,n)}}},function(t,e,n){var r=n(19).f,i=n(8),o=n(5)("toStringTag");t.exports=function(t,e,n){t&&!i(t=n?t:t.prototype,o)&&r(t,o,{configurable:!0,value:e})}},function(t,e,n){var r=n(3),i=r["__core-js_shared__"]||(r["__core-js_shared__"]={});t.exports=function(t){return i[t]||(i[t]={})}},function(t,e,n){var r=n(4),i=n(37),o=n(2);t.exports=function(t,e,n,s){var u=String(o(t)),c=u.length,a=void 0===n?" ":String(n),l=r(e);if(l<=c||""==a)return u;var f=l-c,h=i.call(a,Math.ceil(f/a.length));return h.length>f&&(h=h.slice(0,f)),s?h+u:u+h}},function(t,e,n){"use strict";var r=n(14),i=n(2);t.exports=function(t){var e=String(i(this)),n="",o=r(t);if(o<0||o==1/0)throw RangeError("Count can't be negative");for(;o>0;(o>>>=1)&&(e+=e))1&o&&(n+=e);return n}},function(t,e,n){var r=n(14),i=Math.max,o=Math.min;t.exports=function(t,e){return t=r(t),t<0?i(t+e,0):o(t,e)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(15),i=n(6),o=n(48),s=function(){function t(){}return t.createEventSource=function(t,e,n,s){return r.Preconditions.checkNotNull(t,"url cannot be null"),0!==t.lastIndexOf("http://",0)&&0!==t.lastIndexOf("https://",0)&&(t="http://"+t,i.Logger.warn("url has no default protocol defined. Add http:// as a default protocol.")),new o.StreamData(t,e,n,s)},t}();e.StreamDataIo=s,e.createEventSource=s.createEventSource},function(t,e,n){n(83),n(88),n(95),n(86),n(78),n(79),n(84),n(89),n(91),n(70),n(71),n(72),n(73),n(74),n(75),n(76),n(77),n(80),n(81),n(82),n(85),n(87),n(90),n(92),n(93),n(94),n(96),n(99),n(98),n(100),n(101),n(97),n(68),n(69),t.exports=n(16).String},function(t,e,n){var r=n(102).EventSource;t.exports=r,window&&!window.EventSource&&(window.EventSource=r,"undefined"!=typeof console&&void 0!==console.log&&console.log("polyfill-eventsource added missing EventSource to window"))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(46);e.DefaultStreamDataServer=new r.StreamDataServer("https","streamdata.motwin.net")},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e,n,r,i){this.type=t,this.message=e,this.status=n,this.original=i,this.source=r||"server"}return t.createDefault=function(e){return new t(t.DEFAULT_TYPE,t.DEFAULT_MESSAGE,t.DEFAULT_STATUS,t.DEFAULT_SOURCE,e)},Object.defineProperty(t.prototype,"isServer",{get:function(){return"server"===this.source},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isClient",{get:function(){return"client"===this.source},enumerable:!0,configurable:!0}),t}();r.DEFAULT_TYPE="UnknownError",r.DEFAULT_MESSAGE="An error occured. Please check your console logs for more details.",r.DEFAULT_STATUS=1e3,r.DEFAULT_SOURCE="server",e.StreamDataError=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(15),i=n(6),o=function(){function t(){this._listeners=[]}return t.prototype.fire=function(t){this._listeners.slice().forEach(function(e){var n=e.callback,r=e.context;if(n)try{r?n.apply(r,[t]):n(t)}catch(t){i.Logger.error("Unable to forward event: {0}",t)}})},t.prototype.add=function(t,e){var n={callback:t,context:e};r.Preconditions.checkNotNull(n,"listener cannot be null"),r.Preconditions.checkExpression(-1===this._listeners.indexOf(n),"listener already exists"),this._listeners.push(n)},t.prototype.remove=function(t,e){var n={callback:t,context:e};r.Preconditions.checkNotNull(n,"listener cannot be null");var i=this._listeners.indexOf(n);r.Preconditions.checkExpression(i>=0,"listener not exists"),this._listeners.splice(i,1)},t}();e.Listeners=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,i=n(6),o=n(27),r=window&&window.EventSource,s=function(){function t(t){this._sse=new r(t)}return t.prototype.close=function(){!this._sse||this._sse.readyState!==r.OPEN&&this._sse.readyState!==r.CONNECTING||(i.Logger.info("Closing the SSE Stream."),this._sse.close())},t.prototype.addOpenListener=function(t,e){this._sse.addEventListener(u.OPEN,function(){e?t.apply(e,[{}]):t({})})},t.prototype.addErrorListener=function(t,e){this._sse.addEventListener(u.ERROR,function(n){var r=n?o.JsonHelper.parse(n.data):null;e?t.apply(e,[{error:r}]):t({error:r})})},t.prototype.addDataListener=function(t,e){this._sse.addEventListener(u.DATA,function(n){var r=n?o.JsonHelper.parse(n.data):null;e?t.apply(e,[{data:r}]):t({data:r})})},t.prototype.addPatchListener=function(t,e){this._sse.addEventListener(u.PATCH,function(n){var r=n?o.JsonHelper.parse(n.data):null;e?t.apply(e,[{patch:r}]):t({patch:r})})},t.prototype.addMonitorListener=function(t,e){this._sse.addEventListener(u.MONITOR,function(n){var r=n?o.JsonHelper.parse(n.data):null;e?t.apply(e,[{data:r}]):t({data:r})})},t.prototype.isConnected=function(){return this._sse.readyState===r.OPEN},t}();e.StreamDataEventSource=s;var u=function(){function t(){}return t}();u.OPEN="open",u.ERROR="error",u.DATA="data",u.PATCH="patch",u.MONITOR="monitor",e.EventType=u},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(49),i=function(){function t(t,e,n){this.protocol=t,this.hostname=e,this.port=n}return t.prototype.toString=function(){return r.UrlHelper.urlToString(this.protocol,this.hostname,this.port)},t.prototype.getFullUrl=function(t){return this.toString()+"/"+t.toString()},t}();e.StreamDataServer=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(e,n,r){this.clientUrl=e;var i=r?r.map(function(e){return t.X_SD_HEADER+"="+encodeURIComponent(e)}):[];i.push(t.X_SD_TOKEN+"="+encodeURIComponent(n)),i.length>0&&(this.clientUrl+=-1===this.clientUrl.indexOf("?")?"?":"&",this.clientUrl+=i.join("&"))}return t.prototype.toString=function(){return this.clientUrl},t}();r.X_SD_HEADER="X-Sd-Header",r.X_SD_TOKEN="X-Sd-Token",e.StreamDataUrl=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(45),i=n(44),o=n(15),s=n(6),u=n(42),c=n(43),a=n(47),l=function(){function t(t,e,n,r){o.Preconditions.checkNotNull(t,"url cannot be null."),o.Preconditions.checkNotNull(e,"appToken cannot be null."),this._url=t,this._token=e,this._headers=n||[],this._authStrategy=r,this._openListeners=new i.Listeners,this._dataListeners=new i.Listeners,this._patchListeners=new i.Listeners,this._errorListeners=new i.Listeners,this._monitorListeners=new i.Listeners,this._sse=null,this.server=u.DefaultStreamDataServer}return t.prototype.open=function(){o.Preconditions.checkNotNull(this._url,"url cannot be null"),this._sse&&this.close();var e=this._decorate(this._url,this._headers);return e&&(this._sse=new r.StreamDataEventSource(e),this._sse.addOpenListener(function(t){s.Logger.debug("SSE Stream Opened to "+this._url+"event: "+t),this._openListeners.fire()},this),this._sse.addErrorListener(function(e){e.error?this._errorListeners.fire(t._buildErrorMessage(e.error)):s.Logger.info("SSE server connection lost, retrying ...")},this),this._sse.addDataListener(function(t){s.Logger.debug("Received data:"+t.data),this._dataListeners.fire(t.data)},this),this._sse.addPatchListener(function(t){s.Logger.debug("Received patch:"+t.patch),this._patchListeners.fire(t.patch)},this),this._sse.addMonitorListener(function(t){s.Logger.debug("Received monitor:"+t.data),this._monitorListeners.fire(t.data)},this)),this},t.prototype.close=function(){return this._sse.close(),this},t.prototype.onOpen=function(t,e){return o.Preconditions.checkNotNull(t,"listener cannot be null"),this._openListeners.add(t,e),this},t.prototype.onError=function(t,e){return o.Preconditions.checkNotNull(t,"listener cannot be null"),this._errorListeners.add(t,e),this},t.prototype.onData=function(t,e){return o.Preconditions.checkNotNull(t,"listener cannot be null"),this._dataListeners.add(t,e),this},t.prototype.onPatch=function(t,e){return o.Preconditions.checkNotNull(t,"listener cannot be null"),this._patchListeners.add(t,e),this},t.prototype.onMonitor=function(t,e){return o.Preconditions.checkNotNull(t,"listener cannot be null"),this._monitorListeners.add(t,e),this},t.prototype.isConnected=function(){return this._sse.isConnected()},t.prototype._decorate=function(t,e){o.Preconditions.checkNotNull(t,"url cannot be null");var n=this._authStrategy?this._authStrategy.signUrl(t):t,r=new a.StreamDataUrl(n,this._token,e),i=this.server.getFullUrl(r);return s.Logger.debug("converted url :"+i),i},t._buildErrorMessage=function(t){return s.Logger.error(t),t.cause||t.message||t.status?new c.StreamDataError(t.cause,t.message,t.status,"server",t):c.StreamDataError.createDefault(t)},t}();e.StreamData=l},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(){}return t.urlToString=function(t,e,n){var r=t;return t.endsWith("://")||(r+="://"),r+=e,this._isEmptyPort(n)||(r+=":",r+=n),r},t._isEmptyPort=function(t){return this._isNumber(t)?!t||0===t:!this._isString(t)||(!t||0===t.length)},t._isNumber=function(t){return"number"==typeof t},t._isString=function(t){return"string"==typeof t},t}();e.UrlHelper=r},function(t,e){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},function(t,e,n){var r=n(25),i=n(4),o=n(38);t.exports=function(t){return function(e,n,s){var u,c=r(e),a=i(c.length),l=o(s,a);if(t&&n!=n){for(;a>l;)if((u=c[l++])!=u)return!0}else for(;a>l;l++)if((t||l in c)&&c[l]===n)return t||l||0;return!t&&-1}}},function(t,e,n){var r=n(50);t.exports=function(t,e,n){if(r(t),void 0===e)return t;switch(n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,r){return t.call(e,n,r)};case 3:return function(n,r,i){return t.call(e,n,r,i)}}return function(){return t.apply(e,arguments)}}},function(t,e,n){"use strict";var r=n(10);t.exports=function(){var t=r(this),e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.unicode&&(e+="u"),t.sticky&&(e+="y"),e}},function(t,e,n){t.exports=n(3).document&&document.documentElement},function(t,e,n){t.exports=!n(11)&&!n(7)(function(){return 7!=Object.defineProperty(n(29)("div"),"a",{get:function(){return 7}}).a})},function(t,e,n){var r=n(28);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==r(t)?t.split(""):Object(t)}},function(t,e,n){"use strict";var r=n(59),i=n(0),o=n(20),s=n(9),u=n(8),c=n(58),a=n(31),l=n(34),f=n(62),h=n(5)("iterator"),p=!([].keys&&"next"in[].keys()),d=function(){return this};t.exports=function(t,e,n,v,g,_,y){a(n,e,v);var m,S,E,x=function(t){if(!p&&t in w)return w[t];switch(t){case"keys":case"values":return function(){return new n(this,t)}}return function(){return new n(this,t)}},b=e+" Iterator",O="values"==g,L=!1,w=t.prototype,P=w[h]||w["@@iterator"]||g&&w[g],T=P||x(g),N=g?O?x("entries"):T:void 0,R="Array"==e?w.entries||P:P;if(R&&(E=f(R.call(new t)))!==Object.prototype&&(l(E,b,!0),r||u(E,h)||s(E,h,d)),O&&P&&"values"!==P.name&&(L=!0,T=function(){return P.call(this)}),r&&!y||!p&&!L&&w[h]||s(w,h,T),c[e]=T,c[b]=d,g)if(m={values:O?T:x("values"),keys:_?T:x("keys"),entries:N},y)for(S in m)S in w||o(w,S,m[S]);else i(i.P+i.F*(p||L),e,m);return m}},function(t,e){t.exports={}},function(t,e){t.exports=!1},function(t,e,n){var r=n(10),i=n(61),o=n(30),s=n(21)("IE_PROTO"),u=function(){},c=function(){var t,e=n(29)("iframe"),r=o.length;for(e.style.display="none",n(54).appendChild(e),e.src="javascript:",t=e.contentWindow.document,t.open(),t.write("<script>document.F=Object<\/script>"),t.close(),c=t.F;r--;)delete c.prototype[o[r]];return c()};t.exports=Object.create||function(t,e){var n;return null!==t?(u.prototype=r(t),n=new u,u.prototype=null,n[s]=t):n=c(),void 0===e?n:i(n,e)}},function(t,e,n){var r=n(19),i=n(10),o=n(64);t.exports=n(11)?Object.defineProperties:function(t,e){i(t);for(var n,s=o(e),u=s.length,c=0;u>c;)r.f(t,n=s[c++],e[n]);return t}},function(t,e,n){var r=n(8),i=n(66),o=n(21)("IE_PROTO"),s=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=i(t),r(t,o)?t[o]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?s:null}},function(t,e,n){var r=n(8),i=n(25),o=n(51)(!1),s=n(21)("IE_PROTO");t.exports=function(t,e){var n,u=i(t),c=0,a=[];for(n in u)n!=s&&r(u,n)&&a.push(n);for(;e.length>c;)r(u,n=e[c++])&&(~o(a,n)||a.push(n));return a}},function(t,e,n){var r=n(63),i=n(30);t.exports=Object.keys||function(t){return r(t,i)}},function(t,e){t.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"},function(t,e,n){var r=n(2);t.exports=function(t){return Object(r(t))}},function(t,e,n){var r=n(13);t.exports=function(t,e){if(!r(t))return t;var n,i;if(e&&"function"==typeof(n=t.toString)&&!r(i=n.call(t)))return i;if("function"==typeof(n=t.valueOf)&&!r(i=n.call(t)))return i;if(!e&&"function"==typeof(n=t.toString)&&!r(i=n.call(t)))return i;throw TypeError("Can't convert object to primitive value")}},function(t,e,n){"use strict";var r=n(0),i=n(33)(/[&<>"']/g,{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&apos;"});r(r.P+r.F,"String",{escapeHTML:function(){return i(this)}})},function(t,e,n){"use strict";var r=n(0),i=n(33)(/&(?:amp|lt|gt|quot|apos);/g,{"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&apos;":"'"});r(r.P+r.F,"String",{unescapeHTML:function(){return i(this)}})},function(t,e,n){n(12)("match",1,function(t,e,n){return[function(n){"use strict";var r=t(this),i=void 0==n?void 0:n[e];return void 0!==i?i.call(n,r):new RegExp(n)[e](String(r))},n]})},function(t,e,n){n(12)("replace",2,function(t,e,n){return[function(r,i){"use strict";var o=t(this),s=void 0==r?void 0:r[e];return void 0!==s?s.call(r,o,i):n.call(String(o),r,i)},n]})},function(t,e,n){n(12)("search",1,function(t,e,n){return[function(n){"use strict";var r=t(this),i=void 0==n?void 0:n[e];return void 0!==i?i.call(n,r):new RegExp(n)[e](String(r))},n]})},function(t,e,n){n(12)("split",2,function(t,e,r){"use strict";var i=n(18),o=r,s=[].push,u="length";if("c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1)[u]||2!="ab".split(/(?:ab)*/)[u]||4!=".".split(/(.?)(.?)/)[u]||".".split(/()()/)[u]>1||"".split(/.?/)[u]){var c=void 0===/()??/.exec("")[1];r=function(t,e){var n=String(this);if(void 0===t&&0===e)return[];if(!i(t))return o.call(n,t,e);var r,a,l,f,h,p=[],d=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),v=0,g=void 0===e?4294967295:e>>>0,_=new RegExp(t.source,d+"g");for(c||(r=new RegExp("^"+_.source+"$(?!\\s)",d));(a=_.exec(n))&&!((l=a.index+a[0][u])>v&&(p.push(n.slice(v,a.index)),!c&&a[u]>1&&a[0].replace(r,function(){for(h=1;h<arguments[u]-2;h++)void 0===arguments[h]&&(a[h]=void 0)}),a[u]>1&&a.index<n[u]&&s.apply(p,a.slice(1)),f=a[0][u],v=l,p[u]>=g));)_.lastIndex===a.index&&_.lastIndex++;return v===n[u]?!f&&_.test("")||p.push(""):p.push(n.slice(v)),p[u]>g?p.slice(0,g):p}}else"0".split(void 0,0)[u]&&(r=function(t,e){return void 0===t&&0===e?[]:o.call(this,t,e)});return[function(n,i){var o=t(this),s=void 0==n?void 0:n[e];return void 0!==s?s.call(n,o,i):r.call(String(o),n,i)},r]})},function(t,e,n){"use strict";n(1)("anchor",function(t){return function(e){return t(this,"a","name",e)}})},function(t,e,n){"use strict";n(1)("big",function(t){return function(){return t(this,"big","","")}})},function(t,e,n){"use strict";n(1)("blink",function(t){return function(){return t(this,"blink","","")}})},function(t,e,n){"use strict";n(1)("bold",function(t){return function(){return t(this,"b","","")}})},function(t,e,n){"use strict";var r=n(0),i=n(22)(!1);r(r.P,"String",{codePointAt:function(t){return i(this,t)}})},function(t,e,n){"use strict";var r=n(0),i=n(4),o=n(23),s="".endsWith;r(r.P+r.F*n(17)("endsWith"),"String",{endsWith:function(t){var e=o(this,t,"endsWith"),n=arguments.length>1?arguments[1]:void 0,r=i(e.length),u=void 0===n?r:Math.min(i(n),r),c=String(t);return s?s.call(e,c,u):e.slice(u-c.length,u)===c}})},function(t,e,n){"use strict";n(1)("fixed",function(t){return function(){return t(this,"tt","","")}})},function(t,e,n){"use strict";n(1)("fontcolor",function(t){return function(e){return t(this,"font","color",e)}})},function(t,e,n){"use strict";n(1)("fontsize",function(t){return function(e){return t(this,"font","size",e)}})},function(t,e,n){var r=n(0),i=n(38),o=String.fromCharCode,s=String.fromCodePoint;r(r.S+r.F*(!!s&&1!=s.length),"String",{fromCodePoint:function(t){for(var e,n=[],r=arguments.length,s=0;r>s;){if(e=+arguments[s++],i(e,1114111)!==e)throw RangeError(e+" is not a valid code point");n.push(e<65536?o(e):o(55296+((e-=65536)>>10),e%1024+56320))}return n.join("")}})},function(t,e,n){"use strict";var r=n(0),i=n(23);r(r.P+r.F*n(17)("includes"),"String",{includes:function(t){return!!~i(this,t,"includes").indexOf(t,arguments.length>1?arguments[1]:void 0)}})},function(t,e,n){"use strict";n(1)("italics",function(t){return function(){return t(this,"i","","")}})},function(t,e,n){"use strict";var r=n(22)(!0);n(57)(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,e=this._t,n=this._i;return n>=e.length?{value:void 0,done:!0}:(t=r(e,n),this._i+=t.length,{value:t,done:!1})})},function(t,e,n){"use strict";n(1)("link",function(t){return function(e){return t(this,"a","href",e)}})},function(t,e,n){var r=n(0),i=n(25),o=n(4);r(r.S,"String",{raw:function(t){for(var e=i(t.raw),n=o(e.length),r=arguments.length,s=[],u=0;n>u;)s.push(String(e[u++])),u<r&&s.push(String(arguments[u]));return s.join("")}})},function(t,e,n){var r=n(0);r(r.P,"String",{repeat:n(37)})},function(t,e,n){"use strict";n(1)("small",function(t){return function(){return t(this,"small","","")}})},function(t,e,n){"use strict";var r=n(0),i=n(4),o=n(23),s="".startsWith;r(r.P+r.F*n(17)("startsWith"),"String",{startsWith:function(t){var e=o(this,t,"startsWith"),n=i(Math.min(arguments.length>1?arguments[1]:void 0,e.length)),r=String(t);return s?s.call(e,r,n):e.slice(n,n+r.length)===r}})},function(t,e,n){"use strict";n(1)("strike",function(t){return function(){return t(this,"strike","","")}})},function(t,e,n){"use strict";n(1)("sub",function(t){return function(){return t(this,"sub","","")}})},function(t,e,n){"use strict";n(1)("sup",function(t){return function(){return t(this,"sup","","")}})},function(t,e,n){"use strict";n(24)("trim",function(t){return function(){return t(this,3)}})},function(t,e,n){"use strict";var r=n(0),i=n(22)(!0);r(r.P,"String",{at:function(t){return i(this,t)}})},function(t,e,n){"use strict";var r=n(0),i=n(2),o=n(4),s=n(18),u=n(53),c=RegExp.prototype,a=function(t,e){this._r=t,this._s=e};n(31)(a,"RegExp String",function(){var t=this._r.exec(this._s);return{value:t,done:null===t}}),r(r.P,"String",{matchAll:function(t){if(i(this),!s(t))throw TypeError(t+" is not a regexp!");var e=String(this),n="flags"in c?String(t.flags):u.call(t),r=new RegExp(t.source,~n.indexOf("g")?n:"g"+n);return r.lastIndex=o(t.lastIndex),new a(r,e)}})},function(t,e,n){"use strict";var r=n(0),i=n(36);r(r.P,"String",{padEnd:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0,!1)}})},function(t,e,n){"use strict";var r=n(0),i=n(36);r(r.P,"String",{padStart:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0,!0)}})},function(t,e,n){"use strict";n(24)("trimLeft",function(t){return function(){return t(this,1)}},"trimStart")},function(t,e,n){"use strict";n(24)("trimRight",function(t){return function(){return t(this,2)}},"trimEnd")},function(t,e){!function(t){function e(t,e,n,r){this.bubbles=!1,this.cancelBubble=!1,this.cancelable=!1,this.data=e||null,this.origin=n||"",this.lastEventId=r||"",this.type=t||"message"}if(!t.EventSource||t._eventSourceImportPrefix){var n=(t._eventSourceImportPrefix||"")+"EventSource",r=function(t,e){if(!t||"string"!=typeof t)throw new SyntaxError("Not enough arguments");this.url=t,this.setOptions(e);var n=this;setTimeout(function(){n.poll()},0)};if(r.prototype={CONNECTING:0,OPEN:1,CLOSED:2,defaultOptions:{withCredentials:!1,loggingEnabled:!1,loggingPrefix:"eventsource",interval:500,bufferSizeLimit:1048576,silentTimeout:3e5,retryInterval:3e3,getArgs:{evs_buffer_size_limit:1048576},xhrHeaders:{Accept:"text/event-stream","Cache-Control":"no-cache","X-Requested-With":"XMLHttpRequest"}},setOptions:function(t){var e,n=this.defaultOptions;for(e in n)n.hasOwnProperty(e)&&(this[e]=n[e]);for(e in t)e in n&&t.hasOwnProperty(e)&&(this[e]=t[e]);this.getArgs&&this.bufferSizeLimit&&(this.getArgs.evs_buffer_size_limit=this.bufferSizeLimit),"undefined"!=typeof console&&void 0!==console.log||(this.loggingEnabled=!1)},log:function(t){this.loggingEnabled&&console.log("["+this.loggingPrefix+"]:"+t)},poll:function(){try{if(this.readyState==this.CLOSED)return;this.cleanup(),this.readyState=this.CONNECTING,this.cursor=0,this.cache="",this._xhr=new this.XHR(this),this.resetNoActivityTimer(),this._bufferLimitExcceeded=!1,this._idleTimeout=!1}catch(t){this.log("An error occured during polling"),this.dispatchEvent("error",{type:"error",data:t.message,cause:"ConnectionLost"})}},pollAgain:function(t){var e=this;e.readyState=e.CONNECTING;var n="ConnectionLost";e._idleTimeout?n="IdleTimeout":e._bufferLimitExcceeded&&(n="BufferLimitExcceeded"),e.dispatchEvent("error",{type:"error",data:"Reconnecting ",cause:n}),this._pollTimer=setTimeout(function(){e.poll()},t||0)},cleanup:function(){this.log("evs cleaning up"),this._pollTimer&&(clearInterval(this._pollTimer),this._pollTimer=null),this._noActivityTimer&&(clearInterval(this._noActivityTimer),this._noActivityTimer=null),this._xhr&&(this._xhr.abort(),this._xhr=null)},resetNoActivityTimer:function(){if(this.silentTimeout){this._noActivityTimer&&clearInterval(this._noActivityTimer);var t=this;this._idleTimeout=!1,this._noActivityTimer=setTimeout(function(){!1===t._idleTimeout&&(t._idleTimeout=!0,t.log("Timeout! silentTimeout:"+t.silentTimeout),t.pollAgain())},this.silentTimeout)}},close:function(){this.readyState=this.CLOSED,this.log("Closing connection. readyState: CLOSED"),this.cleanup()},_onxhrdata:function(){var t=this._xhr;if(t.isReady()&&!t.hasError()){this.resetNoActivityTimer(),!1===this._bufferLimitExcceeded&&this.readyState==this.CONNECTING&&(this.readyState=this.OPEN,this.dispatchEvent("open",{type:"open"}));var e=t.getBuffer();!1===this._bufferLimitExcceeded&&e.length>this.bufferSizeLimit&&(this.log("buffer.length > this.bufferSizeLimit"),this._bufferLimitExcceeded=!0,this.pollAgain()),0==this.cursor&&e.length>0&&"\ufeff"==e.substring(0,1)&&(this.cursor=1);var n=this.lastMessageIndex(e);if(n[0]>=this.cursor){var r=n[1],i=e.substring(this.cursor,r);this.parseStream(i),this.cursor=r}t.isDone()&&(this.log("request.isDone(). reopening the connection"),this.pollAgain(this.interval))}else this.readyState!==this.CLOSED&&(this.log("this.readyState !== this.CLOSED"),this.pollAgain(this.interval))},parseStream:function(t){t=this.cache+this.normalizeToLF(t);var n,r,i,o,s,u,c=t.split("\n\n");for(n=0;n<c.length-1;n++){for(i="message",o=[],parts=c[n].split("\n"),r=0;r<parts.length;r++)s=this.trimWhiteSpace(parts[r]),0==s.indexOf("event")?i=s.replace(/event:?\s*/,""):0==s.indexOf("retry")?(u=parseInt(s.replace(/retry:?\s*/,"")),isNaN(u)||(this.interval=u)):0==s.indexOf("data")?o.push(s.replace(/data:?\s*/,"")):0==s.indexOf("id:")?this.lastEventId=s.replace(/id:?\s*/,""):0==s.indexOf("id")&&(this.lastEventId=null);if(o.length){var a=new e(i,o.join("\n"),window.location.origin,this.lastEventId);this.dispatchEvent(i,a)}}this.cache=c[c.length-1]},dispatchEvent:function(t,e){var n=this["_"+t+"Handlers"];if(n)for(var r=0;r<n.length;r++)n[r].call(this,e);this["on"+t]&&this["on"+t].call(this,e)},addEventListener:function(t,e){this["_"+t+"Handlers"]||(this["_"+t+"Handlers"]=[]),this["_"+t+"Handlers"].push(e)},removeEventListener:function(t,e){var n=this["_"+t+"Handlers"];if(n)for(var r=n.length-1;r>=0;--r)if(n[r]===e){n.splice(r,1);break}},_pollTimer:null,_noactivityTimer:null,_xhr:null,lastEventId:null,cache:"",cursor:0,onerror:null,onmessage:null,onopen:null,readyState:0,_idleTimeout:!1,_bufferLimitExcceeded:!1,urlWithParams:function(t,e){var n=[];if(e){var r,i,o=encodeURIComponent;for(r in e)e.hasOwnProperty(r)&&(i=o(r)+"="+o(e[r]),n.push(i))}return n.length>0?-1==t.indexOf("?")?t+"?"+n.join("&"):t+"&"+n.join("&"):t},lastMessageIndex:function(t){var e=t.lastIndexOf("\n\n"),n=t.lastIndexOf("\r\r"),r=t.lastIndexOf("\r\n\r\n");return r>Math.max(e,n)?[r,r+4]:[Math.max(e,n),Math.max(e,n)+2]},trimWhiteSpace:function(t){var e=/^(\s|\u00A0)+|(\s|\u00A0)+$/g;return t.replace(e,"")},normalizeToLF:function(t){return t.replace(/\r\n|\r/g,"\n")}},function(){return!(!window.XDomainRequest||!window.XMLHttpRequest||void 0!==(new XMLHttpRequest).responseType)}()){r.isPolyfill="IE_8-9";var i=r.prototype.defaultOptions;i.xhrHeaders=null,i.getArgs.evs_preamble=2056,r.prototype.XHR=function(t){request=new XDomainRequest,this._request=request,request.onprogress=function(){request._ready=!0,this._failed=!1,t._onxhrdata()},request.onload=function(){this._loaded=!0,this._failed=!1,t._onxhrdata()},request.onerror=function(){this._failed=!0,t._idleTimeout||t._bufferLimitExcceeded||t.pollAgain(t.retryInterval)},request.ontimeout=function(){this._failed=!0,t._idleTimeout||t._bufferLimitExcceeded||t.pollAgain(t.retryInterval)};var e={};if(t.getArgs){var n=t.getArgs;for(var r in n)n.hasOwnProperty(r)&&(e[r]=n[r]);t.lastEventId&&(e.evs_last_event_id=t.lastEventId)}request.open("GET",t.urlWithParams(t.url,e)),request.send()},r.prototype.XHR.prototype={useXDomainRequest:!0,_request:null,_ready:!1,_loaded:!1,_failed:!1,isReady:function(){return this._request._ready},isDone:function(){return this._request._loaded},hasError:function(){return this._request._failed},getBuffer:function(){var t="";try{t=this._request.responseText||""}catch(t){}return t},abort:function(){this._request&&this._request.abort()}}}else r.isPolyfill="XHR",r.prototype.XHR=function(t){request=new XMLHttpRequest,this._request=request,t._xhr=this,request.onreadystatechange=function(){request.readyState>1&&t.readyState!=t.CLOSED&&(200==request.status||request.status>=300&&request.status<400?t._onxhrdata():t._idleTimeout||t._bufferLimitExcceeded||t.pollAgain(t.retryInterval))},request.onprogress=function(){},request.open("GET",t.urlWithParams(t.url,t.getArgs),!0);var e=t.xhrHeaders;for(var n in e)e.hasOwnProperty(n)&&request.setRequestHeader(n,e[n]);t.lastEventId&&request.setRequestHeader("Last-Event-Id",t.lastEventId),t.withCredentials&&(request.withCredentials=!0),request.send()},r.prototype.XHR.prototype={useXDomainRequest:!1,_request:null,_failed:!1,isReady:function(){return this._request.readyState>=2},isDone:function(){return 4==this._request.readyState},hasError:function(){return this._failed||this._request.status>=400},getBuffer:function(){var t="";try{t=this._request.responseText||""}catch(t){}return t},abort:function(){this._request&&this._request.abort()}};t[n]=r}}(this)},function(t,e,n){n(40),n(41),t.exports=n(39)}])});
//# sourceMappingURL=streamdataio.min.js.map